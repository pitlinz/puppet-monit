#!/bin/bash 
#
# script to test for stale mounts
# generated by puppet
#

. /etc/environment

mount | sed -n "s/^.* on \(.*\) type nfs4 .*$/\1/p" |
while read mount_point ; do
        echo "checking $mount_point/monit.txt"
        CHECK=`timeout 10 cat $mount_point/monit.txt || echo "stale"`
        echo "CHECK is: $CHECK"
        if [ "$CHECK" == "stale" ]; then
                exit 0
        fi
done
exit 1